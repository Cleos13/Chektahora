"close"!=localStorage.getItem("menu-estatus")&&null!=localStorage.getItem("menu-estatus")||($(".menu-backoffice").hide(),$("#menu-backoffice").attr({style:"width: 1.4%;"}).addClass("menu-close")),"close"!=localStorage.getItem("menu-estatus-mobile")&&null!=localStorage.getItem("menu-estatus-mobile")||($(".menu-backoffice-mobile").hide(),$(".menu-mobile-options").hide().addClass("menu-close")),$("#btn-backoffice").click(function(){$("#menu-backoffice").hasClass("menu-close")?(localStorage.setItem("menu-estatus","open"),$(".menu-backoffice").show(200),$("#menu-backoffice").attr({style:"width: 450px !important; transition: width 0.6s;"}).removeClass("menu-close")):(localStorage.setItem("menu-estatus","close"),$(".menu-backoffice").hide(),$("#menu-backoffice").attr({style:"width: 1.4%; transition: width 0.5s;"}).addClass("menu-close"))}),$("#menu-mobile-backoffice, #close-mobile-backoffice").click(function(){$(".menu-mobile-options").hasClass("menu-close")?(localStorage.setItem("menu-estatus-mobile","open"),$(".menu-backoffice-mobile").show(),$(".menu-mobile-options").show(100).removeClass("menu-close")):(localStorage.setItem("menu-estatus-mobile","close"),$(".menu-backoffice-mobile").hide(),$(".menu-mobile-options").hide().addClass("menu-close"))});let validate_img_desktop=!1,id_product="",name="";const currency=function(o){return new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN",minimumFractionDigits:2}).format(o)};$("[close-modal]").on("click",function(){$(".modal").removeClass("is-visible")}),$("button[open-pop-n]").on("click",function(){$("#new").toggleClass("is-visible")});let now=moment().format("YYYY-MM-DD");function getPromotionsAll(){$.post("api/promotions.php?get=promotions-all",{},function(o){let t="";for(const e of JSON.parse(o))t+=`<tr>
                        <td style="padding: 20px 30px;">${e.name}</td>
                        <td style="padding: 20px 30px;">${e.type}</td>
                        <td style="padding: 20px 30px;">${e.amount_discount}</td>
                        <td style="padding: 20px 30px;">${e.porcent_discount}%</td>
                        <td style="padding: 20px 30px;">${e.type_discount}</td>
                        <td style="padding: 20px 30px;">${e.date}</td>
                        <td><button class="btn-products px-3" products-promotion="${e.id}">CONDICIONES</button></td>
                        <td>
                            <button class="px-3" type="button" style="cursor: pointer;" delete-promotion="${e.id}">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash3" viewBox="0 0 16 16">
                                  <path d="M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5ZM11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H2.506a.58.58 0 0 0-.01 0H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1h-.995a.59.59 0 0 0-.01 0H11Zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5h9.916Zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47ZM8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5Z"/>
                                </svg>
                            </button>
                        </td>
                    </tr>`;$("#promotions").html(t),$("[delete-promotion]").on("click",function(){var o=$(this).attr("delete-promotion");$.post("api/promotions?action=delete",{id:o},function(){location.reload()})}),$("[products-promotion]").on("click",function(){$("#view-products").addClass("is-visible");var o=$(this).attr("products-promotion");$.post("api/promotions?get=items",{id:o},function(o){let t="";for(const e of JSON.parse(o))t+=`<tr>
                        <td style="padding: 20px 30px;">${e[0]}</td>
                        <td style="padding: 20px 30px;">${e[1]}</td>
                    </tr>`;$("#products-promotion").html(t)})})})}function getProductsAll(){$.post("api/promotions.php?get=products-all",{},function(o){let t="";for(const e of JSON.parse(o))t+=`<option value="${e.id}">${e.name}</option>`;$("[products-list-promotion]").html(t)})}function promotionSelect(o){let t=$("[amount-required]"),e=$("#promotion-include-product"),n=$("#promotion-include-discount"),a=$("#promotion-include-product-and-discount"),i=$("#promotion-include-product-for");i.addClass("display-none"),n.addClass("display-none"),e.addClass("display-none"),t.addClass("display-none"),a.addClass("display-none"),"1"===o&&(t.removeClass("display-none"),i.removeClass("display-none")),"2"===o&&(t.removeClass("display-none"),e.removeClass("display-none")),"3"===o&&(t.removeClass("display-none"),n.removeClass("display-none")),"4"===o&&(t.removeClass("display-none"),a.removeClass("display-none")),"5"===o&&t.removeClass("display-none")}$("#date-orders").daterangepicker({minDate:now,singleDatePicker:!0,maxYear:parseInt(moment().format("YYYY"),10),locale:{format:"YYYY-MM-DD",separator:" - ",applyLabel:"Aplicar",cancelLabel:"Clear",fromLabel:"De",toLabel:"a",customRangeLabel:"Custom",weekLabel:"S",daysOfWeek:["Do","Lu","Ma","Mi","Ju","Vi","Sa"],monthNames:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],firstDay:1}}),getPromotionsAll(),getProductsAll(),$("#promotions-options").on("change",function(){promotionSelect($("[promotion]:selected").attr("promotion"))}),$("#add-item-promotion").on("click",function(){var o=Math.floor(1e6*Math.random()),o=(0===$("[item-promotion]").length&&$("#items-promotion").html(""),$("#items-promotion").append(`<div id="${o}" item-promotion>
                            <div class="grid-x">
                                <div class="large-7 grid-x">
                                    <label class="large-12 mb-2">Compra</label>
                                    <select class="large-8" products-list-promotion="${o}"></select>
                                    <select class="large-3 mx-2 display-none" amount-required="${o}">
                                        <option value="1">1</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                        <option value="5">5</option>
                                        <option value="6">6</option>
                                        <option value="7">7</option>
                                        <option value="8">8</option>
                                        <option value="9">9</option>
                                        <option value="9">9</option>
                                        <option value="10">10</option>
                                    </select>
                                </div>
                                <div class="large-1 flex-center mt-2">
                                    <button class="px-3" type="button" style="cursor: pointer;" delete-item="${o}">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor"
                                             class="bi bi-trash3" viewBox="0 0 16 16">
                                            <path d="M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5ZM11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H2.506a.58.58 0 0 0-.01 0H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1h-.995a.59.59 0 0 0-.01 0H11Zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5h9.916Zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47ZM8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5Z"/>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                        </div>`),$("[promotion]:selected").attr("promotion"));promotionSelect(o),$("#promotions-options").on("change",function(){promotionSelect($("[promotion]:selected").attr("promotion"))}),$("[delete-item]").on("click",function(){var o=$(this).attr("delete-item"),o=(console.log(o),$("#"+o).remove(),$("[item-promotion]").length);0===o&&$("#items-promotion").append('<h5 class="grid-x text-morado text-center fw-bold">Agrega contenido, eliminaste todo.</h5>')}),getProductsAll()}),$("#type-discount").on("change",function(){var o=$(this).val();$("[discount-input]").addClass("display-none"),$("#"+o+"-total").removeClass("display-none")}),$("#type-discount-product").on("change",function(){var o=$(this).val();$("[discount-input-product]").addClass("display-none"),$("#"+o+"-total-product").removeClass("display-none")}),$("#save-new-promotion").on("click",function(){var o=$("#name-new").val(),t=$("#date-orders").val(),e=$("#promotions-options").val(),n=$("#product-apply-for").val(),a=$("#product-apply-free").val(),i=$("#amount-product-apply-free").val(),l=$("#product-apply-and-discount").val(),s=$("#porcent-total-product").val(),r=$("#amount-total-product").val(),p=$("#type-discount-product").val(),c=$("#porcent-total").val(),d=$("#amount-total").val(),m=$("#type-discount").val();let u=[],v=document.querySelectorAll("[item-promotion]");v.forEach(o=>{u.push([$('[products-list-promotion="'+o.id+'"]').val(),$('[amount-required="'+o.id+'"]').val()])});var f=$("[promotion]:selected").attr("promotion");$.post("api/promotions?action=add",{promotion:f,name:o,date:t,type:e,product_1:n,product_2:a,amount_product_2:i,product_4:l,porcent_4:s,amount_4:r,type_discount_4:p,porcent_3:c,amount_3:d,type_discount_3:m,items:u},function(){location.reload()})});