let pay="Conekta";function getOrderData(a){$("[data-shadow]").html(""),$("#estatus_green_data").removeClass("active"),$("#estatus_yellow_data").removeClass("active"),$('[space="data_covid"]').addClass("display-none"),$('[space="data_its"]').addClass("display-none"),$('[space="data_clinicos"]').addClass("display-none"),$.post("api/getOrders.php?get=data_user",{id:a},function(t){var o=JSON.parse(t);$("#promotion").html(o.data[0].promotion),$("#date_pay_data").html(o.data[0].fecha_pago),$("#hours_pay_data").html(o.data[0].hora_pago),$("#name_data").html(o.data[0].nombre),$("#tel_data").html(o.data[0].tel),$("#email_data").html(o.data[0].email),$("#sex_data").html(o.data[0].sexo),$("#fn_data").html(o.data[0].fecha_nacimiento),$("#con_data").html(o.data[0].conoce),$("#street_data").html(o.data[0].calle),$("#no_ext_data").html(o.data[0].no_ext),$("#no_int_data").html(o.data[0].no_int),$("#cp_data").html(o.data[0].cp),$("#suburb_data").html(o.data[0].colonia),$("#municipality_data").html(o.data[0].municipio),$("#state_data").html(o.data[0].estado),$("#id__order").html(o.data[0].ID_compra),$("#date_covid_data").html(o.data[0].fecha_covid),$("#hora_covid_data").html(o.data[0].hora_covid),$("#number_order").html("#"+o.data[0].orden),$.post("api/getOrders.php?get=products_user",{id:a},function(t){var t=JSON.parse(t),a=0,e=0,s=0,t=t.map(function(t){return"covid"==t.categoria?a+=1:"its"==t.categoria?s+=1:"clinicos"==t.categoria&&(e+=1),`<div>- ${t.nombre} (${t.cantidad})</div>`});$("#products_order").prepend(t),1<=a&&($("#med_data").html(o.data[0].medicamentos),$("#sin_data").html(o.data[0].sintomas),$("#pas_data").html(o.data[0].pasaporte),$('[space="data_covid"]').removeClass("display-none")),1<=s&&($("#its_data").html(o.data[0].its),$('[space="data_its"]').removeClass("display-none")),1<=e&&($("#clinicos_data").html(o.data[0].clinicos),$('[space="data_clinicos"]').removeClass("display-none")),0!=$("#id_order").length&&$("#id_order").attr({href:"order?order="+o.data[0].ID}),1==o.data[0].estatus_customer&&$("#estatus_green_data").addClass("active"),1==o.data[0].estatus_logistica&&$("#estatus_yellow_data").addClass("active"),$(".change-estatus").attr({ref:o.data[0].ID}),$("#estatus_logistica").click(function(){updateEstatusL($(this).attr("ref"))}),$("#estatus_customer").click(function(){updateEstatusC($(this).attr("ref"))})}),1==o.data[0].personas_extras&&$.post("api/getOrders.php?get=people_plus",{id:a},function(t){let a='<br><div><h4 class="fw-bold">Personas extras </h4></div>';for(const e of JSON.parse(t))a+=`
                                        <div>
                                            <span class="fw-bold">Nombre y apellidos: </span>
                                            <span>${e.nombre}</span>
                                        </div>
                                        <div>
                                            <span class="fw-bold">Email: </span>
                                            <span>${e.email}</span>
                                        </div>
                                        <div>
                                            <span class="fw-bold">Pasaporte: </span>
                                            <span>${e.pasaporte}</span>
                                        </div>
                                        <div>
                                            <span class="fw-bold">Fecha de nacimiento: </span>
                                            <span>${e.fecha_nacimiento}</span>
                                        </div><br>`;$("#people_plus").html(a)}),$("#data-shadow").show(200).animate({opacity:1})})}function orderTypePay(t,a=""){pay=t,""!=a&&(a=a.split(" - ")),$.post("api/getOrders.php?get=orders&type="+t,{date:a},function(t){t=JSON.parse(t).map(function(e){if("all"==url){let t="",a="";return 1==e.estatus_customer&&(t="active"),1==e.estatus_logistica&&(a="active"),`<tr class="d-flex align-height-center"><td class="px-3 fw-bold">${e.orden}</td><td class="t-name">${e.nombre}</td><td class="t-date"><div class="fw-bold">${e.fecha_pago}</div><div>${e.hora_pago}</div></td><td class="t-estatus"><div><img src="../css/img/backoffice/completed.png" alt="" width="40px;"><span style="font-size: 14px;">Completado</span></div></td><td class="t-products" id="${e.ID}"></td><td class="t-estatus-control d-flex"><div class="estatus_red active"></div><div class="estatus_green ${t}"></div><div class="estatus_yellow ${a}"></div></td><td class="t-icon"><button view-data onclick="getOrderData('${e.ID}')"><img src="../css/img/backoffice/arrow-right.png" alt="" width="17px;"></button></td></tr>`}});$.post("api/getOrders.php?get=products",function(t){JSON.parse(t).map(function(t){var a;"all"==url&&(a=t.id,$("#"+a).prepend(`<div>${t.nombre} (${t.cantidad})</div>`))})}),$("#orders").html(t)})}function updateEstatusL(t){$.post("api/getOrders.php?get=update&type=logistica",{ref:t},function(t){1==t&&($("#alert").removeClass("display-none"),$("#alert").html("Actualizado correctamente"),"all"==url?(orderTypePay("Conekta",""),$("#data-shadow").hide().animate({opacity:0}),setTimeout(function(){$("#alert").addClass("display-none")},4e3)):$.post("api/getOrders.php?get=orders",function(t){t=JSON.parse(t).map(function(t){return`<tr class="d-flex align-height-center"><td class="fw-bold">${t.orden}</td><td class="t-estatus d-flex align-height-center justify-content-center"><img src="../css/img/backoffice/completed.png" alt="" width="40px;"></td><td class="t-date"><div>${t.fecha_pago}</div><div class="fw-bold">${t.hora_pago}</div></td><td class="t-name">${t.nombre}</td><td class="t-products" id="${t.ID}"></td><td class="t-icon"><button view-data onclick="getOrderData('${t.ID}')"><img src="../css/img/backoffice/arrow-right.png" alt="" width="17px;"></button></td></tr>`});$.post("api/getOrders.php?get=products",function(t){JSON.parse(t).map(function(t){var a;"general"==url&&(a=t.id,$("#"+a).prepend(`<div>${t.nombre} (${t.cantidad})</div>`))})}),$("#orders").html(t),$("#data-shadow").hide().animate({opacity:0}),setTimeout(function(){$("#alert").addClass("display-none")},4e3)}))})}function updateEstatusC(t){$.post("api/getOrders.php?get=update&type=customer",{ref:t},function(t){1==t&&($("#alert").removeClass("display-none"),$("#alert").html("Actualizado correctamente"),"all"==url?(orderTypePay("Conekta",""),$("#data-shadow").hide().animate({opacity:0}),setTimeout(function(){$("#alert").addClass("display-none")},4e3)):$.post("api/getOrders.php?get=orders",function(t){t=JSON.parse(t).map(function(t){return`<tr class="d-flex align-height-center"><td class="fw-bold">${t.orden}</td><td class="t-estatus d-flex align-height-center justify-content-center"><img src="../css/img/backoffice/completed.png" alt="" width="40px;"></td><td class="t-date"><div>${t.fecha_pago}</div><div class="fw-bold">${t.hora_pago}</div></td><td class="t-name">${t.nombre}</td><td class="t-products" id="${t.ID}"></td><td class="t-icon"><button view-data onclick="getOrderData('${t.ID}')"><img src="../css/img/backoffice/arrow-right.png" alt="" width="17px;"></button></td></tr>`});$.post("api/getOrders.php?get=products",function(t){JSON.parse(t).map(function(t){var a;"general"==url&&(a=t.id,$("#"+a).prepend(`<div>${t.nombre} (${t.cantidad})</div>`))})}),$("#orders").html(t),$("#data-shadow").hide().animate({opacity:0}),setTimeout(function(){$("#alert").addClass("display-none")},4e3)}))})}$("#close-data-shadow").on("click",function(){$("#data-shadow").hide().animate({opacity:0})}),$(document).ready(function(){if("general"==url&&$.post("api/getOrders.php?get=orders",function(t){t=JSON.parse(t).map(function(t){if("general"==url)return`<tr class="d-flex align-height-center"><td class="fw-bold">${t.orden}</td><td class="t-estatus d-flex align-height-center justify-content-center"><img src="../css/img/backoffice/completed.png" alt="" width="40px;"></td><td class="t-date"><div>${t.fecha_pago}</div><div class="fw-bold">${t.hora_pago}</div></td><td class="t-name">${t.nombre}</td><td class="t-products" id="${t.ID}"></td><td class="t-icon"><button view-data onclick="getOrderData('${t.ID}')"><img src="../css/img/backoffice/arrow-right.png" alt="" width="17px;"></button></td></tr>`});$.post("api/getOrders.php?get=products",function(t){JSON.parse(t).map(function(t){var a;"general"==url&&(a=t.id,$("#"+a).prepend(`<div>${t.nombre} (${t.cantidad})</div>`))})}),$("#orders").html(t)}),"all"==url){let t="Conekta",a="";$("#date-orders").on("change",function(){a=$(this).val(),orderTypePay(t,a)}),orderTypePay("Conekta",a),$(".t-conekta button").on("click",function(){t="Conekta",$(".head-pay button").removeClass("active"),$(this).addClass("active"),orderTypePay("Conekta",a)}),$(".t-rappi button").on("click",function(){t="Rappi",$(".head-pay button").removeClass("active"),$(this).addClass("active"),orderTypePay("Rappi",a)}),$(".t-stripe button").on("click",function(){t="Stripe",$(".head-pay button").removeClass("active"),$(this).addClass("active"),orderTypePay("Stripe",a)})}}),$("#date-orders").daterangepicker({minYear:2022,maxYear:parseInt(moment().format("YYYY"),10),locale:{format:"DD/MM/YYYY",separator:" - ",applyLabel:"Aplicar",cancelLabel:"Clear",fromLabel:"De",toLabel:"a",customRangeLabel:"Custom",weekLabel:"S",daysOfWeek:["Do","Lu","Ma","Mi","Ju","Vi","Sa"],monthNames:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],firstDay:1}}),$("#download-pay").click(function(){let t=$("#date-orders").val();""!=t&&(t=t.split(" - "),console.log(pay),window.location.href="api/report?start="+t[0]+"&end="+t[1]+"&pay="+pay)}),$("#download-general").click(function(){let t=$("#date-orders").val();""!=t&&(t=t.split(" - "),window.location.href="api/report?start="+t[0]+"&end="+t[1])}),"close"!=localStorage.getItem("menu-estatus")&&null!=localStorage.getItem("menu-estatus")||($(".menu-backoffice").hide(),$("#menu-backoffice").attr({style:"width: 1.4%;"}).addClass("menu-close")),"close"!=localStorage.getItem("menu-estatus-mobile")&&null!=localStorage.getItem("menu-estatus-mobile")||($(".menu-backoffice-mobile").hide(),$(".menu-mobile-options").hide().addClass("menu-close")),$("#btn-backoffice").click(function(){$("#menu-backoffice").hasClass("menu-close")?(localStorage.setItem("menu-estatus","open"),$(".menu-backoffice").show(200),$("#menu-backoffice").attr({style:"width: 450px !important; transition: width 0.6s;"}).removeClass("menu-close")):(localStorage.setItem("menu-estatus","close"),$(".menu-backoffice").hide(),$("#menu-backoffice").attr({style:"width: 1.4%; transition: width 0.5s;"}).addClass("menu-close"))}),$("#menu-mobile-backoffice, #close-mobile-backoffice").click(function(){$(".menu-mobile-options").hasClass("menu-close")?(localStorage.setItem("menu-estatus-mobile","open"),$(".menu-backoffice-mobile").show(),$(".menu-mobile-options").show(100).removeClass("menu-close")):(localStorage.setItem("menu-estatus-mobile","close"),$(".menu-backoffice-mobile").hide(),$(".menu-mobile-options").hide().addClass("menu-close"))});